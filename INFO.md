INFO — Pariksha_AI Project Structure & File Map

Purpose
-------
This file documents the repository layout, the purpose of key files and folders, and how components relate to each other. Use this as a quick orientation guide for development, debugging, and on-boarding.

Repository root
---------------
- `README.md` — Project-level readme with setup, usage, and troubleshooting.
- `INFO.md` — (this file) concise map of structure & relationships.
- `MongoDBSchema.md` — Detailed database schema and GridFS / proctoring storage guide.
- `client/` — Frontend (React + Vite + TypeScript).
- `server/` — Backend (Node.js + Express + TypeScript) and ML helpers.
- `temp/` — Temporary folders created during proctoring (video chunk extraction, frames).

Top-level notes
---------------
- The project is split into `client` (UI) and `server` (API + ML).
- ML model code and model weights live under `server/src/ml/` and the Python virtualenv for ML lives there.
- Use `server/.env` to configure backend and ML runtime (critical: `PROCTORING_PYTHON`).

Client (frontend)
------------------
Path: `client/`

Key files & folders:
- `package.json` — frontend dependencies and scripts (`dev`, `build`, `preview`).
- `components.json` — shadcn UI generator config (indicates `client/src/components/ui` created/managed by shadcn generator).
- `index.html` — main HTML template (favicon and head meta often referenced here).
- `src/main.tsx`, `src/App.tsx` — Vite React entry and top-level app component.
- `src/pages/` — page components (StudentLogin, StudentTest, ExaminerDashboard, etc.).
- `src/components/` — UI components; `src/components/ui/` contains shadcn-generated small UI wrappers built on Radix primitives.
- `src/lib/` — helper utilities (API config, shared utils).
- `public/` — static public assets (images, possibly `favicon.ico` if present here).

Notes:
- `components.json` strongly suggests the `ui/` components are generated by shadcn (ui.shadcn.com). Those files follow shadcn patterns and wrap Radix primitives.
- Favicon is normally referenced from `index.html` or `public/` (check `client/index.html` or `client/public/`).

Server (backend + ML)
---------------------
Path: `server/`

Key files & folders:
- `package.json` — backend scripts and dependencies. `main` points to `dist/server.js` for a built artifact; development uses `ts-node src/server.ts`.
- `.gitignore` — ignores `dist/`, `venv/`, `.env`, and other ephemeral files.

Important subfolders:
- `server/src/` — TypeScript source for the backend.
  - `server/src/server.ts` — Main Express application bootstrap. (Note: `dotenv.config()` is expected to run early here so env vars like `PROCTORING_PYTHON` are available.)
  - `server/src/models/` — Mongoose models (User, Test, Question, ExamAttempt, ProctoringLog, Violation, TestRecording). These define collections and indexes.
  - `server/src/utils/` — helper utilities (ex: `mlProctoring.ts` which resolves the Python binary, `gridfs.ts` for GridFS interactions, `faceRecognition.ts`).
  - `server/src/ml/` — ML integration (Python model, helper scripts)
    - `procturingModel.py` — Python script invoked by the backend to analyze video chunks using YOLOv8. Contains `get_model_path()` that resolves `yolov8n.pt` in priority (script dir → server dir, etc.).
    - `requirements.txt` — Python dependencies for ML (OpenCV, torch, ultralytics, etc.).
    - `venv/` — (ignored) Python virtual environment for ML when used locally.
    - `yolov8n.pt` — preferred, canonical model file stored in `server/src/ml/` (keep this one; a redundant copy in `server/` can be removed).
- `server/models/` — prebuilt compiled model outputs or additional model artifacts (some repos contain compiled JS in `dist/models/` for runtime compatibility). In this repository `server/dist/models/TestRecording.js` exists — that is a compiled (JS) version of the TypeScript Mongoose model.

Build artifacts and `dist`
-------------------------
- `dist/` is a build output (TypeScript compiled to CommonJS JS). `server/.gitignore` contains `dist/` so compiled files are normally not committed.
- If `server/dist/models/TestRecording.js` appears in the repo, it may be a leftover commit of build outputs. Because `package.json` uses `ts-node` for dev and `tsc` for `build`, and `.gitignore` excludes `dist/`, compiled files should not be tracked. If `dist/` files ARE present in the repo, they are probably redundant and can be removed (or you should re-generate and commit only if you intentionally track build outputs). See below for guidance.

ML model weight files
---------------------
- Keep `server/src/ml/yolov8n.pt` (canonical model used by `procturingModel.py`). There is a duplicate at `server/yolov8n.pt` — remove the duplicate to avoid confusion.

Database & Storage
------------------
- MongoDB is the primary datastore (Atlas or local). Key collections (via Mongoose models):
  - `users` — user accounts with face descriptor for biometric authentication.
  - `tests` — test definitions and schedule.
  - `questions` — question bank.
  - `examattempts` — student attempts (answers, trustScore, totalViolations).
  - `proctoringlogs` — detailed violation records referencing GridFS images.
- GridFS collections used for storing violation screenshots (large binary objects):
  - `cheatingImages.files` — file metadata (filename, metadata.attemptId, label, severity)
  - `cheatingImages.chunks` — binary chunks of the file data

Relationships (high level)
--------------------------
- `User` (examiner) creates `Test` documents that reference `Question` documents.
- `Student` (User) creates one `ExamAttempt` per `Test`. `ExamAttempt` stores answers, `trustScore`, `totalViolations`.
- The ML pipeline inspects webcam video chunks and produces `ProctoringLog` entries for violations. Each `ProctoringLog` can reference a GridFS image (`cheatingImages.files._id`).
- `GridFS files` → `GridFS chunks` (file metadata points to binary chunks by `_id`/`files_id`).

Build / Run notes
-----------------
- Backend (development):

```powershell
cd server
npm run dev  # uses ts-node to run TypeScript directly
```

- Frontend (development):

```powershell
cd client
npm run dev  # Vite dev server
```

- To build backend for production (emit `dist/` JS):

```powershell
cd server
npm run build  # runs `tsc`, produces dist/ by default
```

If `dist/` files were previously committed, either remove them from the repository (recommended) with `git rm --cached` and add `dist/` to `.gitignore`, or if you intentionally track build outputs keep them but ensure they are updated regularly.

Specific file guidance & maintenance
-----------------------------------
- `server/.env`: critical. Ensure `PROCTORING_PYTHON` points to the Python interpreter with ML dependencies installed (Conda env or venv). Example:
  - Windows (venv): `C:\Users\you\...\server\src\ml\venv\Scripts\python.exe`
- `server/src/utils/mlProctoring.ts`: TypeScript logic used by backend to find the Python binary and spawn the proctoring script. This determines which Python gets used at runtime.
- `server/src/ml/procturingModel.py`: Python proctoring logic — keep current debug-friendly version. It searches for `yolov8n.pt` relative to the script and parent `server/` dir.
- `server/src/ml/yolov8n.pt`: Keep this one. Remove `server/yolov8n.pt` duplicate.
- `server/src/models/*`: Mongoose models. If you find compiled `dist/models/*.js` committed, they are redundant; prefer the TS model sources in `server/src/models`.
- `client/components.json` and `client/src/components/ui`: If you want to regenerate/update UI wrappers, use the shadcn generator and `components.json` settings.

Recommendations
---------------
1. Remove duplicate ML weight: `server/yolov8n.pt` (keep `server/src/ml/yolov8n.pt`).
2. Remove committed build output in `server/dist/` if present and ensure `server/.gitignore` includes `dist/` (it already does). To remove tracked `dist/` from git while keeping files locally:

```powershell
# from repo root
git rm -r --cached server/dist
git commit -m "Remove tracked build outputs (dist/) from repo"
```

3. Keep `components.json` under source control — it documents generated UI config.
4. Keep `server/src/ml/requirements.txt` updated and document how to create the Python venv in `README.md` (you already have that info).

What I changed now
------------------
- Created `INFO.md` at repository root with this summary (file saved).

Next steps I can do for you
--------------------------
- Run `git log -- client/src/components/ui` to see who/when created the shadcn files and whether they were hand-written.
- Run a quick repository audit to list accidentally committed build outputs (`git ls-files | grep "dist/"`).
- Remove duplicate `yolov8n.pt` for you if you want me to (I can run the deletion command or create a patch to delete the file). Which would you like me to do next?